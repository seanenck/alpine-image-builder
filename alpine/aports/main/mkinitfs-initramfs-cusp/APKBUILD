pkgname=mkinitfs-initramfs-cusp
pkgver=3.10.2
pkgrel=2
pkgdesc="Overrides mkinitfs initram default(s)"
options="!check"
url="https://github.com/seanenck/image-build"
arch="noarch"
license="GPL-2.0-only"
makedepends_host="busybox kmod-dev util-linux-dev cryptsetup-dev linux-headers"
makedepends="$makedepends_host"
depends="mkinitfs"
source="
https://gitlab.alpinelinux.org/alpine/mkinitfs/-/archive/$pkgver/mkinitfs-$pkgver.tar.gz
0001-mkinitfs-initram-rw-tmpfs.patch
"

replaces=mkinitfs
replaces_priority=900
builddir="$srcdir/mkinitfs-$pkgver"

build() {
	make VERSION=$pkgver-r$pkgrel
}

package() {
    install -Dm644 initramfs-init "$pkgdir/usr/share/mkinitfs/initramfs-init"
}

sha512sums="
2b5963ab407924eb9fb7dad69e0da35aa95811465e5911dc84d4b94e8d05927102a7551afb02f7674f77571c0499d1f0b84f313dab98dfe396a8f26ea3681e65  mkinitfs-3.10.2.tar.gz
255505f4ff5ebeab655df2297a3ccd07960382059ce4612dd94d0c65c7ded0917a22e57539ec884f72bfddb73234fb35770bda53d0cedd364e375b163d27d3a5  0001-mkinitfs-initram-rw-tmpfs.patch
"
